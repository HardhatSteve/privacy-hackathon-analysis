import{j as e}from"./index-HKquI-t2.js";import{r,P as Ke,S as Pe,C as Te,a as Ae,u as Be,b as Me}from"./wallet-adapters-BrkyT213.js";import{K as R,f as Ce,e as Ie,M as G,A as Re,S as J,l as Ee,m as De,n as Z,j as Le,o as Oe,p as q,q as Q,T as Y}from"./solana-core-C4IjULEX.js";import{d as X,s as S,r as k}from"./privacyUtils-p52_K7k3.js";import{e as _e}from"./cryptoNote-CBMOi0Hg.js";import{W as We,a as $e}from"./wallet-ui-CFNU3nNx.js";const Ue="https://api.devnet.solana.com",Fe="https://nerti-w8e6l5-fast-mainnet.helius-rpc.com";function He({lines:a}){const n=r.useRef(null);return r.useEffect(()=>{var s;(s=n.current)==null||s.scrollIntoView({behavior:"smooth"})},[a]),e.jsxs("div",{className:"mt-6 bg-white/5 rounded-xl p-4 border border-white/10 text-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"font-semibold text-white/80",children:"Activity Log"})}),e.jsxs("div",{className:"space-y-1 font-mono text-white/70 max-h-64 overflow-auto text-xs",children:[a.length===0?e.jsx("div",{className:"text-white/40",children:"No activity yet."}):a.map((s,i)=>e.jsxs("div",{className:s.type==="error"?"text-red-400":s.type==="success"?"text-emerald-400":"",children:[e.jsxs("span",{className:"text-white/40",children:["[",new Date(s.t).toLocaleTimeString(),"]"]})," ",s.msg]},i)),e.jsx("div",{ref:n})]})]})}function Ve(){const[a,n]=r.useState([]),s=r.useCallback((l,o="info")=>{n(c=>[...c,{t:Date.now(),msg:l,type:o}]),console.log(l)},[]),i=r.useCallback(()=>n([]),[]);return{lines:a,log:s,clear:i}}async function ze(a,n=0){const s=new TextEncoder().encode(`stealth-launch-v1:${n}:derive-stealth-wallet`),i=await a(s),l=await crypto.subtle.digest("SHA-256",i),o=new Uint8Array(l);return R.fromSeed(o)}const Ge="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function Je(a){const n=[0];for(const s of a){let i=s;for(let l=0;l<n.length;l++)i+=n[l]<<8,n[l]=i%58,i=Math.floor(i/58);for(;i>0;)n.push(i%58),i=Math.floor(i/58)}for(const s of a){if(s!==0)break;n.push(0)}return n.reverse().map(s=>Ge[s]).join("")}async function ee(a){const{blockhash:n,lastValidBlockHeight:s}=await a.getLatestBlockhash("confirmed");return{blockhash:n,lastValidBlockHeight:s}}async function Ze({connection:a,publicKey:n,signTransaction:s,ixs:i,log:l}){const o=new Y().add(...i),{blockhash:c,lastValidBlockHeight:h}=await ee(a);o.recentBlockhash=c,o.feePayer=n;const x=await s(o),m=await a.sendRawTransaction(x.serialize(),{maxRetries:3,skipPreflight:!1});return l(`Submitted (main): ${m.slice(0,20)}...`),await a.confirmTransaction({signature:m,blockhash:c,lastValidBlockHeight:h},"confirmed"),m}async function I({connection:a,feePayer:n,signers:s,ixs:i,log:l}){const o=new Y().add(...i),{blockhash:c,lastValidBlockHeight:h}=await ee(a);o.recentBlockhash=c,o.feePayer=n,o.sign(...s);const x=await a.sendRawTransaction(o.serialize(),{maxRetries:3,skipPreflight:!1});return l(`Submitted (derived): ${x.slice(0,20)}...`),await a.confirmTransaction({signature:x,blockhash:c,lastValidBlockHeight:h},"confirmed"),x}function qe({isDevnet:a,setIsDevnet:n}){const{publicKey:s,connected:i,signTransaction:l,signMessage:o}=Be(),{connection:c}=Me(),[h,x]=r.useState(!0),[m,te]=r.useState("TOKEN"),[K,se]=r.useState(""),[P,ae]=r.useState(""),[b,re]=r.useState(6),[f,ne]=r.useState("1000000"),[y,E]=r.useState("random"),[T,Qe]=r.useState(0),[v,ie]=r.useState(!1),[j,le]=r.useState(""),[g,oe]=r.useState("burn"),[D,L]=r.useState(!1),[A,O]=r.useState(""),[ce,de]=r.useState(""),[_,W]=r.useState(""),[$,U]=r.useState(""),[Xe,F]=r.useState([]),{lines:he,log:d,clear:H}=Ve(),ue=r.useCallback(async()=>{L(!0),O(""),W(""),U(""),F([]);try{if(!i||!s)throw new Error("Connect wallet first");H(),d("Generating stealth wallet...");let t;if(y==="deterministic"){if(!o)throw new Error("Wallet doesnt support message signing");t=await ze(o,T),d(`Derived wallet (index ${T}): ${t.publicKey.toBase58()}`)}else{t=R.generate();const N=Je(t.secretKey);W(N),d(`Random wallet: ${t.publicKey.toBase58()}`)}de(t.publicKey.toBase58());const p=m==="TOKEN2022"?Ce:Ie,V=await c.getMinimumBalanceForRentExemption(G),me=await c.getMinimumBalanceForRentExemption(Re),xe=.015*1e9,z=V+me+Math.floor(xe);d(`Funding derived with ${(z/1e9).toFixed(4)} SOL`),h&&(d("Performing decoy reads..."),await X(c),await S(k(500,1500)));const w=[],pe=await Ze({connection:c,publicKey:s,signTransaction:l,ixs:[J.transfer({fromPubkey:s,toPubkey:t.publicKey,lamports:z})],log:d});w.push(pe),h&&(await S(k(800,2e3)),await X(c)),d("Creating mint...");const u=R.generate(),be=[J.createAccount({fromPubkey:t.publicKey,newAccountPubkey:u.publicKey,lamports:V,space:G,programId:p}),Ee(u.publicKey,Number(b),t.publicKey,t.publicKey,p)],ge=await I({connection:c,feePayer:t.publicKey,signers:[t,u],ixs:be,log:d});w.push(ge),h&&await S(k(500,1200)),d("Minting supply...");const B=await De(u.publicKey,t.publicKey,!1,p,Z),we=10n**BigInt(b),ye=BigInt(Math.round(parseFloat(f||"0")*Number(we))),fe=[Le(t.publicKey,B,t.publicKey,u.publicKey,p,Z),Oe(u.publicKey,B,t.publicKey,ye,Number(b),[],p)],ve=await I({connection:c,feePayer:t.publicKey,signers:[t],ixs:fe,log:d});if(w.push(ve),g!=="keep"){h&&await S(k(300,800));const N=g==="transfer"?s:null,Se=[q(u.publicKey,t.publicKey,Q.MintTokens,N,[],p),q(u.publicKey,t.publicKey,Q.FreezeAccount,N,[],p)],ke=await I({connection:c,feePayer:t.publicKey,signers:[t],ixs:Se,log:d});w.push(ke),d(g==="burn"?"Authorities burned":"Authorities transferred","success")}const M=u.publicKey.toBase58();O(M),F(w),d(`Mint created: ${M}`,"success");const je={version:1,createdAt:new Date().toISOString(),program:m,token:{name:K,symbol:P,decimals:b,supply:f,mint:M,tokenAccount:B.toBase58()},stealth:{derivedWallet:t.publicKey.toBase58(),derivationMode:y},authorities:g,transactions:w};let C=JSON.stringify(je,null,2);v&&j.trim().length&&(C=await _e(C,j.trim()));const Ne=new Blob([C],{type:"application/json"});U(URL.createObjectURL(Ne)),d("Stealth launch complete!","success")}catch(t){console.error(t),d(`Error: ${t.message}`,"error")}finally{L(!1)}},[i,s,l,o,c,m,b,f,g,K,P,v,j,h,y,T,H,d]);return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-950 to-slate-900 text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-4",children:e.jsx("a",{href:"/",className:"text-white/60 hover:text-white",children:"â† Back"})}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Stealth Token Creator"}),e.jsx("p",{className:"text-white/60 mb-6",children:"Create SPL tokens from a burner wallet with privacy features."}),e.jsx("div",{className:"mb-6",children:e.jsx($e,{})}),e.jsx("div",{className:"mb-6 p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"âš ï¸"}),e.jsx("span",{className:"text-sm text-yellow-200",children:"Test on devnet first"})]}),e.jsx("button",{onClick:()=>n(!a),className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition ${a?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/50":"bg-red-500/20 text-red-400 border border-red-500/50"}`,children:a?"ðŸ§ª Devnet":"ðŸ”´ Mainnet"})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"Token Program"}),e.jsxs("select",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",value:m,onChange:t=>te(t.target.value),children:[e.jsx("option",{value:"TOKEN",children:"Token Program (classic)"}),e.jsx("option",{value:"TOKEN2022",children:"Token-2022"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"Name"}),e.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",value:K,onChange:t=>se(t.target.value),placeholder:"My Token"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"Symbol"}),e.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",value:P,onChange:t=>ae(t.target.value.toUpperCase()),placeholder:"TKN"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"Decimals"}),e.jsxs("select",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",value:b,onChange:t=>re(parseInt(t.target.value)),children:[e.jsx("option",{value:0,children:"0"}),e.jsx("option",{value:6,children:"6"}),e.jsx("option",{value:9,children:"9"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"Supply"}),e.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",value:f,onChange:t=>ne(t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"Stealth Wallet"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>E("random"),className:`p-2 rounded-lg border text-sm ${y==="random"?"border-emerald-500 bg-emerald-500/10":"border-white/10"}`,children:"Random"}),e.jsx("button",{type:"button",onClick:()=>E("deterministic"),className:`p-2 rounded-lg border text-sm ${y==="deterministic"?"border-emerald-500 bg-emerald-500/10":"border-white/10"}`,children:"Deterministic"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-white/70 mb-1",children:"After Launch"}),e.jsxs("select",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",value:g,onChange:t=>oe(t.target.value),children:[e.jsx("option",{value:"burn",children:"Burn authorities"}),e.jsx("option",{value:"transfer",children:"Transfer to main"}),e.jsx("option",{value:"keep",children:"Keep on derived"})]})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:t=>x(t.target.checked)}),e.jsx("span",{className:"text-white/70",children:"Privacy mode"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:t=>ie(t.target.checked)}),e.jsx("span",{className:"text-white/70",children:"Encrypt receipt"})]}),v&&e.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-lg p-2.5 text-white",type:"password",placeholder:"Passphrase",value:j,onChange:t=>le(t.target.value)}),e.jsx("button",{onClick:ue,disabled:!i||D,className:"w-full rounded-lg px-4 py-3 bg-emerald-500 hover:bg-emerald-400 disabled:opacity-50 font-semibold",children:D?"Creating...":"Stealth Launch"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[e.jsx("h3",{className:"font-semibold text-white/80 mb-3",children:"Results"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white/50",children:"Derived:"})," ",e.jsx("span",{className:"font-mono text-xs",children:ce||"â€”"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white/50",children:"Mint:"})," ",A?e.jsx("a",{href:`https://solscan.io/token/${A}`,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-xs text-emerald-400",children:A}):"â€”"]}),_&&e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded p-2 mt-2",children:[e.jsx("div",{className:"text-amber-400 text-xs font-semibold",children:"Save Private Key!"}),e.jsx("input",{type:"password",readOnly:!0,value:_,className:"w-full bg-black/30 rounded p-1 text-xs font-mono mt-1",onFocus:t=>t.target.type="text",onBlur:t=>t.target.type="password"})]}),$&&e.jsx("a",{href:$,download:"launch.json",className:"block text-center px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm mt-2",children:"Download Receipt"})]})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[e.jsx("h3",{className:"font-semibold text-white/80 mb-2",children:"How It Works"}),e.jsxs("ul",{className:"list-disc ml-5 text-sm text-white/60 space-y-1",children:[e.jsx("li",{children:"Burner wallet creates the mint"}),e.jsx("li",{children:"Jittered funding + decoy reads"}),e.jsx("li",{children:"Optional authority burn"})]})]})]})]}),e.jsx(He,{lines:he})]})})}function nt(){const[a,n]=r.useState(()=>(localStorage.getItem("cluster")||"devnet")==="devnet"),s=o=>{localStorage.setItem("cluster",o?"devnet":"mainnet"),n(o)},i=r.useMemo(()=>[new Ke,new Pe],[]),l=a?Ue:Fe;return e.jsx(Te,{endpoint:l,children:e.jsx(Ae,{wallets:i,autoConnect:!0,children:e.jsx(We,{children:e.jsx(qe,{isDevnet:a,setIsDevnet:s})})})},l)}export{nt as default};
